authors: Nick Siow
name: Image used has recent Inspector/vulnerability scan
categories: Configuration
functions: Security
resources: EC2
maturity: Low
csps: AWS
applies:
summary: |
  - Ensure AMIs have undergone Inspector/vulnerability scans
  - Flag/prevent EC2 instances launched with AMIs which have not undergone approved scans
how_to:
description: |
  Golden images offer a high-leverage location for vulnerability scans without needing to scan every EC2 instance. Once a golden image has been scanned and passed, the only drift between that and EC2 instances should be minor runtime changes.

  Protected tags can be used as a way to demarcate which images have undergone successful Inspector scans and used as a source of truth for this guardrail. This guardrail can also be combined with tag-based IAM Conditions to turn into a preventative control where relevant.
links:
  - https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazonec2.html#amazonec2-RunInstances
